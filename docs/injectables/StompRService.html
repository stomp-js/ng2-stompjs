<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>@stomp/ng2-stompjs documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/Vagrant.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">@stomp/ng2-stompjs documentation</a>
            <button type="button" class="btn btn-default btn-menu fa fa-bars" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
            <div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search">
</div>
            <nav>

    <ul class="list">

        <li class="title">
            <a href="index.html" data-type="index-link">@stomp/ng2-stompjs documentation</a>
        </li>

        <li class="divider"></li>


        <li class="chapter">
            <a data-type="chapter-link" href="index.html"><span class="fa fa-home"></span>Getting started</a>
            <ul class="links">
                    <li class="link">
                        <a 
                            
                             href="overview.html" 
                             href="overview.html" 
                            data-type="chapter-link">
                            <span class="fa fa-fw fa-th"></span>Overview
                        </a>
                    </li>
                    <li class="link">
                      <a href="index.html" data-type="chapter-link"><span class="fa fa-file-text-o"></span>README</a>
                    </li>
                    <li class="link">
                            <a href="changelog.html"
                        data-type="chapter-link">
                            <span class="fa fa-fw fa-file-text-o"></span>CHANGELOG
                        </a>
                    </li>
                    <li class="link">
                            <a href="license.html"
                        data-type="chapter-link">
                            <span class="fa fa-fw fa-file-text-o"></span>LICENSE
                        </a>
                    </li>
                    <li class="link">
                        <a href="dependencies.html"
                            data-type="chapter-link">
                            <span class="fa fa-fw fa-list"></span>Dependencies
                        </a>
                    </li>
            </ul>
        </li>

        <li class="chapter">
            <div class="simple menu-toggler" data-toggle="collapse"
                    data-target="#xs-additional-pages"
                >
                <span class="fa fa-fw fa-book"></span>
                <span>Guides</span>
                <span class="fa fa-angle-down"></span>
            </div>
            <ul class="links collapse"
                    id="xs-additional-pages"
                >
                    <li class="link ">
                        <a href="additional-documentation/sock-js.html" data-type="entity-link" data-context-id="additional">Sock JS</a>
                    </li>
                    <li class="link ">
                        <a href="additional-documentation/contributing.html" data-type="entity-link" data-context-id="additional">Contributing</a>
                    </li>
            </ul>
        </li>

        <li class="chapter modules">
            <a data-type="chapter-link" href="modules.html">
                <div class="menu-toggler linked" data-toggle="collapse"
                        data-target="#xs-modules-links"
                >
                    <span class="fa fa-fw fa-archive"></span>
                    <span class="link-name">Modules</span>
                    <span class="fa fa-angle-down"></span>
                </div>
            </a>
            <ul class="links collapse"
                    id="xs-modules-links"
                >
                    <li class="link">
                        <a href="modules/AppModule.html" data-type="entity-link">AppModule</a>
                    </li>
            </ul>
        </li>



        <li class="chapter">
            <div class="simple menu-toggler" data-toggle="collapse"
                    data-target="#xs-classes-links"
                >
                <span class="fa fa-fw fa-file-code-o"></span>
                <span>Classes</span>
                <span class="fa fa-angle-down"></span>
            </div>
            <ul class="links collapse"
                    id="xs-classes-links"
                >
                    <li class="link">
                        <a href="classes/MyStompRService.html" data-type="entity-link">MyStompRService</a>
                    </li>
                    <li class="link">
                        <a href="classes/MyStompService.html" data-type="entity-link">MyStompService</a>
                    </li>
            </ul>
        </li>

                <li class="chapter">
                    <div class="simple menu-toggler" data-toggle="collapse"
                            data-target="#xs-injectables-links"
                        >
                        <span class="fa fa-fw fa-long-arrow-down"></span>
                        <span>Injectables</span>
                        <span class="fa fa-angle-down"></span>
                    </div>
                    <ul class="links collapse"
                            id="xs-injectables-links"
                        >
                            <li class="link">
                                <a href="injectables/StompConfig.html" data-type="entity-link">StompConfig</a>
                            </li>
                            <li class="link">
                                <a href="injectables/StompRService.html" data-type="entity-link">StompRService</a>
                            </li>
                            <li class="link">
                                <a href="injectables/StompService.html" data-type="entity-link">StompService</a>
                            </li>
                    </ul>
                </li>




        <li class="chapter">
            <div class="simple menu-toggler" data-toggle="collapse"
                    data-target="#xs-miscellaneous-links"
                >
                <span class="fa fa-fw fa-cubes"></span>
                <span>Miscellaneous</span>
                <span class="fa fa-angle-down"></span>
            </div>
            <ul class="links collapse"
                    id="xs-miscellaneous-links"
                >
                    <li class="link">
                      <a href="miscellaneous/enumerations.html" data-type="entity-link">Enums</a>
                    </li>
                    <li class="link">
                      <a href="miscellaneous/functions.html" data-type="entity-link">Functions</a>
                    </li>
                    <li class="link">
                      <a href="miscellaneous/typealiases.html" data-type="entity-link">Type aliases</a>
                    </li>
                    <li class="link">
                      <a href="miscellaneous/variables.html" data-type="entity-link">Variables</a>
                    </li>
            </ul>
        </li>


        <li class="chapter">
            <a data-type="chapter-link" href="coverage.html"><span class="fa fa-fw fa-tasks"></span>Documentation coverage</a>
        </li>


    </ul>

</nav>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <nav>

    <ul class="list">

        <li class="title">
            <a href="index.html" data-type="index-link">@stomp/ng2-stompjs documentation</a>
        </li>

        <li class="divider"></li>

            <div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search">
</div>

        <li class="chapter">
            <a data-type="chapter-link" href="index.html"><span class="fa fa-home"></span>Getting started</a>
            <ul class="links">
                    <li class="link">
                        <a 
                            
                             href="overview.html" 
                             href="overview.html" 
                            data-type="chapter-link">
                            <span class="fa fa-fw fa-th"></span>Overview
                        </a>
                    </li>
                    <li class="link">
                      <a href="index.html" data-type="chapter-link"><span class="fa fa-file-text-o"></span>README</a>
                    </li>
                    <li class="link">
                            <a href="changelog.html"
                        data-type="chapter-link">
                            <span class="fa fa-fw fa-file-text-o"></span>CHANGELOG
                        </a>
                    </li>
                    <li class="link">
                            <a href="license.html"
                        data-type="chapter-link">
                            <span class="fa fa-fw fa-file-text-o"></span>LICENSE
                        </a>
                    </li>
                    <li class="link">
                        <a href="dependencies.html"
                            data-type="chapter-link">
                            <span class="fa fa-fw fa-list"></span>Dependencies
                        </a>
                    </li>
            </ul>
        </li>

        <li class="chapter">
            <div class="simple menu-toggler" data-toggle="collapse"
                    data-target="#additional-pages"
>
                <span class="fa fa-fw fa-book"></span>
                <span>Guides</span>
                <span class="fa fa-angle-down"></span>
            </div>
            <ul class="links collapse"
                    id="additional-pages"
>
                    <li class="link ">
                        <a href="additional-documentation/sock-js.html" data-type="entity-link" data-context-id="additional">Sock JS</a>
                    </li>
                    <li class="link ">
                        <a href="additional-documentation/contributing.html" data-type="entity-link" data-context-id="additional">Contributing</a>
                    </li>
            </ul>
        </li>

        <li class="chapter modules">
            <a data-type="chapter-link" href="modules.html">
                <div class="menu-toggler linked" data-toggle="collapse"
                        data-target="#modules-links"
                >
                    <span class="fa fa-fw fa-archive"></span>
                    <span class="link-name">Modules</span>
                    <span class="fa fa-angle-down"></span>
                </div>
            </a>
            <ul class="links collapse"
                    id="modules-links"
>
                    <li class="link">
                        <a href="modules/AppModule.html" data-type="entity-link">AppModule</a>
                    </li>
            </ul>
        </li>



        <li class="chapter">
            <div class="simple menu-toggler" data-toggle="collapse"
                    data-target="#classes-links"
>
                <span class="fa fa-fw fa-file-code-o"></span>
                <span>Classes</span>
                <span class="fa fa-angle-down"></span>
            </div>
            <ul class="links collapse"
                    id="classes-links"
>
                    <li class="link">
                        <a href="classes/MyStompRService.html" data-type="entity-link">MyStompRService</a>
                    </li>
                    <li class="link">
                        <a href="classes/MyStompService.html" data-type="entity-link">MyStompService</a>
                    </li>
            </ul>
        </li>

                <li class="chapter">
                    <div class="simple menu-toggler" data-toggle="collapse"
                            data-target="#injectables-links"
>
                        <span class="fa fa-fw fa-long-arrow-down"></span>
                        <span>Injectables</span>
                        <span class="fa fa-angle-down"></span>
                    </div>
                    <ul class="links collapse"
                            id="injectables-links"
>
                            <li class="link">
                                <a href="injectables/StompConfig.html" data-type="entity-link">StompConfig</a>
                            </li>
                            <li class="link">
                                <a href="injectables/StompRService.html" data-type="entity-link">StompRService</a>
                            </li>
                            <li class="link">
                                <a href="injectables/StompService.html" data-type="entity-link">StompService</a>
                            </li>
                    </ul>
                </li>




        <li class="chapter">
            <div class="simple menu-toggler" data-toggle="collapse"
                    data-target="#miscellaneous-links"
>
                <span class="fa fa-fw fa-cubes"></span>
                <span>Miscellaneous</span>
                <span class="fa fa-angle-down"></span>
            </div>
            <ul class="links collapse"
                    id="miscellaneous-links"
>
                    <li class="link">
                      <a href="miscellaneous/enumerations.html" data-type="entity-link">Enums</a>
                    </li>
                    <li class="link">
                      <a href="miscellaneous/functions.html" data-type="entity-link">Functions</a>
                    </li>
                    <li class="link">
                      <a href="miscellaneous/typealiases.html" data-type="entity-link">Type aliases</a>
                    </li>
                    <li class="link">
                      <a href="miscellaneous/variables.html" data-type="entity-link">Variables</a>
                    </li>
            </ul>
        </li>


        <li class="chapter">
            <a data-type="chapter-link" href="coverage.html"><span class="fa fa-fw fa-tasks"></span>Documentation coverage</a>
        </li>


    </ul>

</nav>
               </div>
               <!-- START CONTENT -->
               <div class="content injectable">
                   <div class="content-data">






<ol class="breadcrumb">
  <li>Injectables</li>
  <li>StompRService</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
    <li class="active">
        <a href="#info" id="info-tab" role="tab" data-toggle="tab" data-link="info">Info</a>
    </li>


    <li>
        <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
    </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/stomp-r.service.ts</code>
        </p>

            <p class="comment">
                <h3>Description</h3>
            </p>
            <p class="comment">
                <p>Angular2 STOMP Raw Service using @stomp/stomp.js</p>
<p>You will only need the public properties and
methods listed unless you are an advanced user. This service handles subscribing to a
message queue using the stomp.js library, and returns
values via the ES6 Observable specification for
asynchronous value streaming by wiring the STOMP
messages into an observable.</p>
<p>If you will like to pass the configuration as a dependency,
please use StompService class.</p>

            </p>


            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Protected</span>
                                <a href="#client">client</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#connectObservable">connectObservable</a>
                            </li>
                            <li>
                                    <span class="modifier">Protected</span>
                                <a href="#debug">debug</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#defaultMessagesObservable">defaultMessagesObservable</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#errorSubject">errorSubject</a>
                            </li>
                            <li>
                                    <span class="modifier">Protected</span>
                                <a href="#on_connect">on_connect</a>
                            </li>
                            <li>
                                    <span class="modifier">Protected</span>
                                <a href="#on_error">on_error</a>
                            </li>
                            <li>
                                    <span class="modifier">Protected</span>
                                <a href="#queuedMessages">queuedMessages</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#receiptsObservable">receiptsObservable</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#serverHeadersObservable">serverHeadersObservable</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#state">state</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#connected">connected</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#disconnect">disconnect</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#initAndConnect">initAndConnect</a>
                            </li>
                            <li>
                                    <span class="modifier">Protected</span>
                                <a href="#initStompClient">initStompClient</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#publish">publish</a>
                            </li>
                            <li>
                                    <span class="modifier">Protected</span>
                                <a href="#sendQueuedMessages">sendQueuedMessages</a>
                            </li>
                            <li>
                                    <span class="modifier">Protected</span>
                                <a href="#setupOnReceive">setupOnReceive</a>
                            </li>
                            <li>
                                    <span class="modifier">Protected</span>
                                <a href="#setupReceipts">setupReceipts</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#subscribe">subscribe</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#waitForReceipt">waitForReceipt</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section>
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                                <span class="modifier">Public</span>
                        <code>constructor()</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="91" class="link-to-prism">src/stomp-r.service.ts:91</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div class="io-description"><p>Constructor</p>
<p>See README and samples for configuration examples</p>
</div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section>
    
        <h3 id="methods">
            Methods
        </h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="connected"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            connected
                            </b>
                            <a href="#connected"><span class="fa fa-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                            <span class="modifier-icon fa fa-reset"></span>
                        <code>connected()</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="200" class="link-to-prism">src/stomp-r.service.ts:200</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div class="io-description"><p>It will return <code>true</code> if STOMP broker is connected and <code>false</code> otherwise.</p>
</div>

                            <div class="io-description">
                                <b>Returns : </b>    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="disconnect"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            disconnect
                            </b>
                            <a href="#disconnect"><span class="fa fa-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                            <span class="modifier-icon fa fa-reset"></span>
                        <code>disconnect()</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="184" class="link-to-prism">src/stomp-r.service.ts:184</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div class="io-description"><p>It will disconnect from the STOMP broker.</p>
</div>

                            <div class="io-description">
                                <b>Returns : </b>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="initAndConnect"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            initAndConnect
                            </b>
                            <a href="#initAndConnect"><span class="fa fa-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                            <span class="modifier-icon fa fa-reset"></span>
                        <code>initAndConnect()</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="162" class="link-to-prism">src/stomp-r.service.ts:162</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div class="io-description"><p>It will connect to the STOMP broker.</p>
</div>

                            <div class="io-description">
                                <b>Returns : </b>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="initStompClient"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Protected</span>
                            initStompClient
                            </b>
                            <a href="#initStompClient"><span class="fa fa-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                            <span class="modifier-icon fa fa-reset"></span>
                        <code>initStompClient()</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="127" class="link-to-prism">src/stomp-r.service.ts:127</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div class="io-description"><p>It will initialize STOMP Client. </p>
</div>

                            <div class="io-description">
                                <b>Returns : </b>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="publish"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            publish
                            </b>
                            <a href="#publish"><span class="fa fa-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                            <span class="modifier-icon fa fa-reset"></span>
                        <code>publish(queueName: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, message: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, headers: <a href="../undefineds/StompHeaders.html">StompHeaders</a>)</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="214" class="link-to-prism">src/stomp-r.service.ts:214</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div class="io-description"><p>It will send a message to a named destination. The message must be <code>string</code>.</p>
<p>The message will get locally queued if the STOMP broker is not connected. It will attempt to
publish queued messages as soon as the broker gets connected.</p>
</div>

                            <div class="io-description">
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                                    <td>Default value</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>queueName</td>
                                                        <td>
                                                                    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                                        </td>
                                                    
                                                    <td>
                                                            no
                                                    </td>
                                                    
                                                        <td>
                                                        </td>

                                                </tr>
                                                <tr>
                                                        <td>message</td>
                                                        <td>
                                                                    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                                        </td>
                                                    
                                                    <td>
                                                            no
                                                    </td>
                                                    
                                                        <td>
                                                        </td>

                                                </tr>
                                                <tr>
                                                        <td>headers</td>
                                                        <td>
                                                                    <code><a href="../miscellaneous/typealiases.html#StompHeaders" target="_self" >StompHeaders</a></code>
                                                        </td>
                                                    
                                                    <td>
                                                            no
                                                    </td>
                                                    
                                                        <td>
                                                                <code>{}</code>
                                                        </td>

                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                            <div>
                            </div>
                            <div class="io-description">
                                <b>Returns : </b>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                            </div>
                                <div class="io-description">
                                    
                                </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="sendQueuedMessages"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Protected</span>
                            sendQueuedMessages
                            </b>
                            <a href="#sendQueuedMessages"><span class="fa fa-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                            <span class="modifier-icon fa fa-reset"></span>
                        <code>sendQueuedMessages()</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="224" class="link-to-prism">src/stomp-r.service.ts:224</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div class="io-description"><p>It will send queued messages. </p>
</div>

                            <div class="io-description">
                                <b>Returns : </b>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="setupOnReceive"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Protected</span>
                            setupOnReceive
                            </b>
                            <a href="#setupOnReceive"><span class="fa fa-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                            <span class="modifier-icon fa fa-reset"></span>
                        <code>setupOnReceive()</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="317" class="link-to-prism">src/stomp-r.service.ts:317</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div class="io-description"><p>It will handle messages received in the default queue. Messages that would not be handled otherwise
get delivered to the default queue.</p>
</div>

                            <div class="io-description">
                                <b>Returns : </b>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="setupReceipts"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Protected</span>
                            setupReceipts
                            </b>
                            <a href="#setupReceipts"><span class="fa fa-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                            <span class="modifier-icon fa fa-reset"></span>
                        <code>setupReceipts()</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="328" class="link-to-prism">src/stomp-r.service.ts:328</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div class="io-description"><p>It will emit all receipts.</p>
</div>

                            <div class="io-description">
                                <b>Returns : </b>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="subscribe"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            subscribe
                            </b>
                            <a href="#subscribe"><span class="fa fa-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                            <span class="modifier-icon fa fa-reset"></span>
                        <code>subscribe(queueName: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, headers: <a href="../undefineds/StompHeaders.html">StompHeaders</a>)</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="253" class="link-to-prism">src/stomp-r.service.ts:253</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div class="io-description"><p>It will subscribe to server message queues</p>
<p>This method can be safely called even if the STOMP broker is not connected.
If the underlying STOMP connection drops and reconnects, it will resubscribe automatically.</p>
<p>If a header field &#39;ack&#39; is not explicitly passed, &#39;ack&#39; will be set to &#39;auto&#39;. If you
do not understand what it means, please leave it as is.</p>
<p>Note that when working with temporary queues where the subscription request
creates the
underlying queue, mssages might be missed during reconnect. This issue is not specific
to this library but the way STOMP brokers are designed to work.</p>
</div>

                            <div class="io-description">
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                                    <td>Default value</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>queueName</td>
                                                        <td>
                                                                    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                                        </td>
                                                    
                                                    <td>
                                                            no
                                                    </td>
                                                    
                                                        <td>
                                                        </td>

                                                </tr>
                                                <tr>
                                                        <td>headers</td>
                                                        <td>
                                                                    <code><a href="../miscellaneous/typealiases.html#StompHeaders" target="_self" >StompHeaders</a></code>
                                                        </td>
                                                    
                                                    <td>
                                                            no
                                                    </td>
                                                    
                                                        <td>
                                                                <code>{}</code>
                                                        </td>

                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                            <div>
                            </div>
                            <div class="io-description">
                                <b>Returns : </b>    <code>Observable&lt;Stomp.Message&gt;</code>

                            </div>
                                <div class="io-description">
                                    
                                </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="waitForReceipt"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            waitForReceipt
                            </b>
                            <a href="#waitForReceipt"><span class="fa fa-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                            <span class="modifier-icon fa fa-reset"></span>
                        <code>waitForReceipt(receiptId: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>, callback: (frame: Stomp.Frame) => void)</code>
                    </td>
                </tr>


                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="339" class="link-to-prism">src/stomp-r.service.ts:339</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div class="io-description"><p>Wait for receipt, this indicates that server has carried out the related operation</p>
</div>

                            <div class="io-description">
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>receiptId</td>
                                                        <td>
                                                                    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                                        </td>
                                                    
                                                    <td>
                                                            no
                                                    </td>
                                                    

                                                </tr>
                                                <tr>
                                                        <td>callback</td>
                                                        <td>
                                                                    <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/function" target="_blank" >function</a></code>
                                                        </td>
                                                    
                                                    <td>
                                                            no
                                                    </td>
                                                    

                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                            <div>
                            </div>
                            <div class="io-description">
                                <b>Returns : </b>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                            </div>
                                <div class="io-description">
                                    
                                </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section>
    
        <h3 id="inputs">
            Properties
        </h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="client"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Protected</span>
                            client
                            </b>
                            <a href="#client"><span class="fa fa-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <span class="modifier-icon fa fa-reset"></span><code>client:     <code>Stomp.Client</code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code>Stomp.Client</code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="91" class="link-to-prism">src/stomp-r.service.ts:91</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>STOMP Client from @stomp/stomp.js</p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="connectObservable"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            connectObservable
                            </b>
                            <a href="#connectObservable"><span class="fa fa-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <span class="modifier-icon fa fa-reset"></span><code>connectObservable:     <code><a href="../miscellaneous/enumerations.html#StompState" target="_self" >Observable&lt;StompState&gt;</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="../miscellaneous/enumerations.html#StompState" target="_self" >Observable&lt;StompState&gt;</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="49" class="link-to-prism">src/stomp-r.service.ts:49</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Will trigger when connection is established. Use this to carry out initialization.
It will trigger every time a (re)connection occurs. If it is already connected
it will trigger immediately. You can safely ignore the value, as it will always be
StompState.CONNECTED</p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="debug"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Protected</span>
                            debug
                            </b>
                            <a href="#debug"><span class="fa fa-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <span class="modifier-icon fa fa-reset"></span><code>debug:     <code></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>(args: any): void &#x3D;&gt; {
      console.log(new Date(), args);
  }</code>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="353" class="link-to-prism">src/stomp-r.service.ts:353</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Callback Functions</p>
<p>Note the method signature: () =&gt; preserves lexical scope
if we need to use this.x inside the function</p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="defaultMessagesObservable"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            defaultMessagesObservable
                            </b>
                            <a href="#defaultMessagesObservable"><span class="fa fa-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <span class="modifier-icon fa fa-reset"></span><code>defaultMessagesObservable:     <code>Subject&lt;Stomp.Message&gt;</code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code>Subject&lt;Stomp.Message&gt;</code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="65" class="link-to-prism">src/stomp-r.service.ts:65</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Will emit all messages to the default queue (any message that are not handled by a subscription)</p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="errorSubject"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            errorSubject
                            </b>
                            <a href="#errorSubject"><span class="fa fa-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <span class="modifier-icon fa fa-reset"></span><code>errorSubject:     <code>Subject&lt;string | Stomp.Message&gt;</code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code>Subject&lt;string | Stomp.Message&gt;</code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="76" class="link-to-prism">src/stomp-r.service.ts:76</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Will trigger when an error occurs. This Subject can be used to handle errors from
the stomp broker.</p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="on_connect"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Protected</span>
                            on_connect
                            </b>
                            <a href="#on_connect"><span class="fa fa-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <span class="modifier-icon fa fa-reset"></span><code>on_connect:     <code></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>(frame: Frame) &#x3D;&gt; {

    this.debug(&#x27;Connected&#x27;);

    this._serverHeadersBehaviourSubject.next(frame.headers);

    // Indicate our connected state to observers
    this.state.next(StompState.CONNECTED);
  }</code>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="358" class="link-to-prism">src/stomp-r.service.ts:358</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Callback run on successfully connecting to server </p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="on_error"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Protected</span>
                            on_error
                            </b>
                            <a href="#on_error"><span class="fa fa-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <span class="modifier-icon fa fa-reset"></span><code>on_error:     <code></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>(error: string | Stomp.Message) &#x3D;&gt; {

    // Trigger the error subject
    this.errorSubject.next(error);

    if (typeof error &#x3D;&#x3D;&#x3D; &#x27;object&#x27;) {
      error &#x3D; (&lt;Stomp.Message&gt;error).body;
    }

    this.debug(&#x60;Error: ${error}&#x60;);

    // Check for dropped connection and try reconnecting
    if (!this.client.connected) {
      // Reset state indicator
      this.state.next(StompState.CLOSED);
    }
  }</code>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="369" class="link-to-prism">src/stomp-r.service.ts:369</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Handle errors from stomp.js </p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="queuedMessages"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Protected</span>
                            queuedMessages
                            </b>
                            <a href="#queuedMessages"><span class="fa fa-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <span class="modifier-icon fa fa-reset"></span><code>queuedMessages:     <code>literal type[]</code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code>literal type[]</code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>[]</code>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="81" class="link-to-prism">src/stomp-r.service.ts:81</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Internal array to hold locally queued messages when STOMP broker is not connected.</p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="receiptsObservable"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            receiptsObservable
                            </b>
                            <a href="#receiptsObservable"><span class="fa fa-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <span class="modifier-icon fa fa-reset"></span><code>receiptsObservable:     <code>Subject&lt;Stomp.Frame&gt;</code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code>Subject&lt;Stomp.Frame&gt;</code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="70" class="link-to-prism">src/stomp-r.service.ts:70</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Will emit all receipts</p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="serverHeadersObservable"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            serverHeadersObservable
                            </b>
                            <a href="#serverHeadersObservable"><span class="fa fa-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <span class="modifier-icon fa fa-reset"></span><code>serverHeadersObservable:     <code><a href="../miscellaneous/typealiases.html#StompHeaders" target="_self" >Observable&lt;StompHeaders&gt;</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="../miscellaneous/typealiases.html#StompHeaders" target="_self" >Observable&lt;StompHeaders&gt;</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="58" class="link-to-prism">src/stomp-r.service.ts:58</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>Provides headers from most recent connection to the server as return by the CONNECTED
frame.
If the STOMP connection has already been established it will trigger immediately.
It will additionally trigger in event of reconnection, the value will be set of headers from
the recent server response.</p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="state"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            state
                            </b>
                            <a href="#state"><span class="fa fa-link"></span></a>
                        </span>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <span class="modifier-icon fa fa-reset"></span><code>state:     <code><a href="../miscellaneous/enumerations.html#StompState" target="_self" >BehaviorSubject&lt;StompState&gt;</a></code>
</code>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code><a href="../miscellaneous/enumerations.html#StompState" target="_self" >BehaviorSubject&lt;StompState&gt;</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="41" class="link-to-prism">src/stomp-r.service.ts:41</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                        <div class="io-description"><p>State of the STOMPService</p>
<p>It is a BehaviorSubject and will emit current status immediately. This will typically get
used to show current status to the end user.</p>
</div>
                    </td>
                </tr>

            </tbody>
        </table>
</section>

            <section>
    <h3 id="accessors">
        Accessors
    </h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="config"></a>
                        <span class="name"><b>config</b><a href="#config"><span class="fa fa-link"></span></a></span>
                    </td>
                </tr>


                <tr>
                    <td class="col-md-4">
                        <span class="accessor"><b>set</b><code>config(value: )</code></span>
                    </td>
                </tr>
                            <tr>
                                <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="122" class="link-to-prism">src/stomp-r.service.ts:122</a></div>
                                </td>
                            </tr>
                    <tr>
                        <td class="col-md-4">
                                <div class="io-description"><p>Set configuration </p>
</div>

                                <div class="io-description">
                                        <b>Parameters :</b>
                                        <table class="params">
                                            <thead>
                                                <tr>
                                                    <td>Name</td>
                                                    <td>Optional</td>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                    <tr>
                                                        <td>value</td>
                                                    
                                                    
                                                        <td>
                                                                no
                                                        </td>
                                                        
                                                    </tr>
                                            </tbody>
                                        </table>
                                </div>
                                <div>
                                </div>
                                <div class="io-description">
                                    <b>Returns : </b>    <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                                </div>
                        </td>
                    </tr>
            </tbody>
        </table>
</section>
    </div>


    <div class="tab-pane fade tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Injectable } from &#x27;@angular/core&#x27;;

import { BehaviorSubject } from &#x27;rxjs/BehaviorSubject&#x27;;
import { Observable } from &#x27;rxjs/Observable&#x27;;
import { Observer } from &#x27;rxjs/Observer&#x27;;
import { Subject } from &#x27;rxjs/Subject&#x27;;
import { Subscription } from &#x27;rxjs/Subscription&#x27;;

import &#x27;rxjs/add/operator/filter&#x27;;
import &#x27;rxjs/add/operator/first&#x27;;
import &#x27;rxjs/add/operator/share&#x27;;

import { StompConfig } from &#x27;./stomp.config&#x27;;

import * as Stomp from &#x27;@stomp/stompjs&#x27;;
import { Frame, StompSubscription } from &#x27;@stomp/stompjs&#x27;;
import { StompHeaders } from &#x27;./stomp-headers&#x27;;
import { StompState } from &#x27;./stomp-state&#x27;;

/**
 * Angular2 STOMP Raw Service using @stomp/stomp.js
 *
 * You will only need the public properties and
 * methods listed unless you are an advanced user. This service handles subscribing to a
 * message queue using the stomp.js library, and returns
 * values via the ES6 Observable specification for
 * asynchronous value streaming by wiring the STOMP
 * messages into an observable.
 *
 * If you will like to pass the configuration as a dependency,
 * please use StompService class.
 */
@Injectable()
export class StompRService {
  /**
   * State of the STOMPService
   *
   * It is a BehaviorSubject and will emit current status immediately. This will typically get
   * used to show current status to the end user.
   */
  public state: BehaviorSubject&lt;StompState&gt;;

  /**
   * Will trigger when connection is established. Use this to carry out initialization.
   * It will trigger every time a (re)connection occurs. If it is already connected
   * it will trigger immediately. You can safely ignore the value, as it will always be
   * StompState.CONNECTED
   */
  public connectObservable: Observable&lt;StompState&gt;;

  /**
   * Provides headers from most recent connection to the server as return by the CONNECTED
   * frame.
   * If the STOMP connection has already been established it will trigger immediately.
   * It will additionally trigger in event of reconnection, the value will be set of headers from
   * the recent server response.
   */
  public serverHeadersObservable: Observable&lt;StompHeaders&gt;;

  private _serverHeadersBehaviourSubject: BehaviorSubject&lt;null|StompHeaders&gt;;

  /**
   * Will emit all messages to the default queue (any message that are not handled by a subscription)
   */
  public defaultMessagesObservable: Subject&lt;Stomp.Message&gt;;

  /**
   * Will emit all receipts
   */
  public receiptsObservable: Subject&lt;Stomp.Frame&gt;;

  /**
   * Will trigger when an error occurs. This Subject can be used to handle errors from
   * the stomp broker.
   */
  public errorSubject: Subject&lt;string | Stomp.Message&gt;;

  /**
   * Internal array to hold locally queued messages when STOMP broker is not connected.
   */
  protected queuedMessages: {queueName: string, message: string, headers: StompHeaders}[]&#x3D; [];

  /**
   * Configuration
   */
  private _config: StompConfig;

  /**
   * STOMP Client from @stomp/stomp.js
   */
  protected client: Stomp.Client;

  /**
   * Constructor
   *
   * See README and samples for configuration examples
   */
  public constructor() {
    this.state &#x3D; new BehaviorSubject&lt;StompState&gt;(StompState.CLOSED);

    this.connectObservable &#x3D; this.state
      .filter((currentState: StompState) &#x3D;&gt; {
        return currentState &#x3D;&#x3D;&#x3D; StompState.CONNECTED;
      });

    // Setup sending queuedMessages
    this.connectObservable.subscribe(() &#x3D;&gt; {
      this.sendQueuedMessages();
    });

    this._serverHeadersBehaviourSubject &#x3D; new BehaviorSubject&lt;null|StompHeaders&gt;(null);

    this.serverHeadersObservable &#x3D; this._serverHeadersBehaviourSubject
      .filter((headers: null | StompHeaders) &#x3D;&gt; {
        return headers !&#x3D;&#x3D; null;
      });

    this.errorSubject &#x3D; new Subject();
  }

  /** Set configuration */
  set config(value: StompConfig) {
    this._config &#x3D; value;
  }

  /** It will initialize STOMP Client. */
  protected initStompClient(): void {
    // disconnect if connected
    this.disconnect();

    // url takes precedence over socketFn
    if (typeof(this._config.url) &#x3D;&#x3D;&#x3D; &#x27;string&#x27;) {
      this.client &#x3D; Stomp.client(this._config.url);
    } else {
      this.client &#x3D; Stomp.over(this._config.url);
    }

    // Configure client heart-beating
    this.client.heartbeat.incoming &#x3D; this._config.heartbeat_in;
    this.client.heartbeat.outgoing &#x3D; this._config.heartbeat_out;

    // Auto reconnect
    this.client.reconnect_delay &#x3D; this._config.reconnect_delay;

    if (!this._config.debug) {
      this.debug &#x3D; function() {};
    }
    // Set function to debug print messages
    this.client.debug &#x3D; this.debug;

    // Default messages
    this.setupOnReceive();

    // Receipts
    this.setupReceipts();
  }


  /**
   * It will connect to the STOMP broker.
   */
  public initAndConnect(): void {
    this.initStompClient();

    if (!this._config.headers) {
      this._config.headers &#x3D; {};
    }

    // Attempt connection, passing in a callback
    this.client.connect(
      this._config.headers,
      this.on_connect,
      this.on_error
    );

    this.debug(&#x27;Connecting...&#x27;);
    this.state.next(StompState.TRYING);
  }


  /**
   * It will disconnect from the STOMP broker.
   */
  public disconnect(): void {

    // Disconnect if connected. Callback will set CLOSED state
    if (this.client &amp;&amp; this.client.connected) {
      // Notify observers that we are disconnecting!
      this.state.next(StompState.DISCONNECTING);

      this.client.disconnect(
        () &#x3D;&gt; this.state.next(StompState.CLOSED)
      );
    }
  }

  /**
   * It will return &#x60;true&#x60; if STOMP broker is connected and &#x60;false&#x60; otherwise.
   */
  public connected(): boolean {
    return this.state.getValue() &#x3D;&#x3D;&#x3D; StompState.CONNECTED;
  }

  /**
   * It will send a message to a named destination. The message must be &#x60;string&#x60;.
   *
   * The message will get locally queued if the STOMP broker is not connected. It will attempt to
   * publish queued messages as soon as the broker gets connected.
   *
   * @param queueName
   * @param message
   * @param headers
   */
  public publish(queueName: string, message: string, headers: StompHeaders &#x3D; {}): void {
    if (this.connected()) {
      this.client.send(queueName, headers, message);
    } else {
      this.debug(&#x60;Not connected, queueing ${message}&#x60;);
      this.queuedMessages.push({queueName: &lt;string&gt;queueName, message: &lt;string&gt;message, headers: headers});
    }
  }

  /** It will send queued messages. */
  protected sendQueuedMessages(): void {
    const queuedMessages &#x3D; this.queuedMessages;
    this.queuedMessages &#x3D; [];

    this.debug(&#x60;Will try sending queued messages ${queuedMessages}&#x60;);

    for (const queuedMessage of queuedMessages) {
      this.debug(&#x60;Attempting to send ${queuedMessage}&#x60;);
      this.publish(queuedMessage.queueName, queuedMessage.message, queuedMessage.headers);
    }
  }

  /**
   * It will subscribe to server message queues
   *
   * This method can be safely called even if the STOMP broker is not connected.
   * If the underlying STOMP connection drops and reconnects, it will resubscribe automatically.
   *
   * If a header field &#x27;ack&#x27; is not explicitly passed, &#x27;ack&#x27; will be set to &#x27;auto&#x27;. If you
   * do not understand what it means, please leave it as is.
   *
   * Note that when working with temporary queues where the subscription request
   * creates the
   * underlying queue, mssages might be missed during reconnect. This issue is not specific
   * to this library but the way STOMP brokers are designed to work.
   *
   * @param queueName
   * @param headers
   */
  public subscribe(queueName: string, headers: StompHeaders &#x3D; {}): Observable&lt;Stomp.Message&gt; {

    /* Well the logic is complicated but works beautifully. RxJS is indeed wonderful.
     *
     * We need to activate the underlying subscription immediately if Stomp is connected. If not it should
     * subscribe when it gets next connected. Further it should re establish the subscription whenever Stomp
     * successfully reconnects.
     *
     * Actual implementation is simple, we filter the BehaviourSubject &#x27;state&#x27; so that we can trigger whenever Stomp is
     * connected. Since &#x27;state&#x27; is a BehaviourSubject, if Stomp is already connected, it will immediately trigger.
     *
     * The observable that we return to caller remains same across all reconnects, so no special handling needed at
     * the message subscriber.
     */
    this.debug(&#x60;Request to subscribe ${queueName}&#x60;);

    // By default auto acknowledgement of messages
    if (!headers[&#x27;ack&#x27;]) {
      headers[&#x27;ack&#x27;] &#x3D; &#x27;auto&#x27;;
    }

    const coldObservable &#x3D; Observable.create(
      (messages: Observer&lt;Stomp.Message&gt;) &#x3D;&gt; {
        /*
         * These variables will be used as part of the closure and work their magic during unsubscribe
         */
        let stompSubscription: StompSubscription;

        let stompConnectedSubscription: Subscription;

        stompConnectedSubscription &#x3D; this.connectObservable
          .subscribe(() &#x3D;&gt; {
            this.debug(&#x60;Will subscribe to ${queueName}&#x60;);
            stompSubscription &#x3D; this.client.subscribe(queueName, (message: Stomp.Message) &#x3D;&gt; {
                messages.next(message);
              },
              headers);
          });

        return () &#x3D;&gt; { /* cleanup function, will be called when no subscribers are left */
          this.debug(&#x60;Stop watching connection state (for ${queueName})&#x60;);
          stompConnectedSubscription.unsubscribe();

          if (this.state.getValue() &#x3D;&#x3D;&#x3D; StompState.CONNECTED) {
            this.debug(&#x60;Will unsubscribe from ${queueName} at Stomp&#x60;);
            stompSubscription.unsubscribe();
          } else {
            this.debug(&#x60;Stomp not connected, no need to unsubscribe from ${queueName} at Stomp&#x60;);
          }
        };
      });

    /**
     * Important - convert it to hot Observable - otherwise, if the user code subscribes
     * to this observable twice, it will subscribe twice to Stomp broker. (This was happening in the current example).
     * A long but good explanatory article at https://medium.com/@benlesh/hot-vs-cold-observables-f8094ed53339
     */
    return coldObservable.share();
  }

  /**
   * It will handle messages received in the default queue. Messages that would not be handled otherwise
   * get delivered to the default queue.
   */
  protected setupOnReceive(): void {
    this.defaultMessagesObservable &#x3D; new Subject();

    this.client.onreceive &#x3D; (message: Stomp.Message) &#x3D;&gt; {
      this.defaultMessagesObservable.next(message);
    };
  }

  /**
   * It will emit all receipts.
   */
  protected setupReceipts(): void {
    this.receiptsObservable &#x3D; new Subject();

    this.client.onreceipt &#x3D; (frame: Stomp.Frame) &#x3D;&gt; {
      this.receiptsObservable.next(frame);
    };
  }

  /**
   * Wait for receipt, this indicates that server has carried out the related operation
   */
  public waitForReceipt(receiptId: string, callback: (frame: Stomp.Frame) &#x3D;&gt; void): void {
    this.receiptsObservable.filter((frame: Stomp.Frame) &#x3D;&gt; {
      return frame.headers[&#x27;receipt-id&#x27;] &#x3D;&#x3D;&#x3D; receiptId;
    }).first().subscribe((frame: Stomp.Frame) &#x3D;&gt; {
      callback(frame);
    });
  }

  /**
   * Callback Functions
   *
   * Note the method signature: () &#x3D;&gt; preserves lexical scope
   * if we need to use this.x inside the function
   */
  protected debug &#x3D; (args: any): void &#x3D;&gt; {
      console.log(new Date(), args);
  }

  /** Callback run on successfully connecting to server */
  protected on_connect &#x3D; (frame: Frame) &#x3D;&gt; {

    this.debug(&#x27;Connected&#x27;);

    this._serverHeadersBehaviourSubject.next(frame.headers);

    // Indicate our connected state to observers
    this.state.next(StompState.CONNECTED);
  }

  /** Handle errors from stomp.js */
  protected on_error &#x3D; (error: string | Stomp.Message) &#x3D;&gt; {

    // Trigger the error subject
    this.errorSubject.next(error);

    if (typeof error &#x3D;&#x3D;&#x3D; &#x27;object&#x27;) {
      error &#x3D; (&lt;Stomp.Message&gt;error).body;
    }

    this.debug(&#x60;Error: ${error}&#x60;);

    // Check for dropped connection and try reconnecting
    if (!this.client.connected) {
      // Reset state indicator
      this.state.next(StompState.CLOSED);
    }
  }
}

</code></pre>
    </div>

</div>









                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

        <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_URL = 'StompRService.html';
        </script>

       <script src="../js/search/search.js"></script>
       <script src="../js/search/lunr.min.js"></script>
       <script src="../js/search/search-lunr.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
       <script src="../js/search/search_index.js"></script>


    </body>
</html>
